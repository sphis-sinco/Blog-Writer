import json, sys
from os import listdir
from os.path import isfile, join

iteration = 6

folderMode = False
folder = ''

fileNames = []
filePaths = []
fileJsons = []

if sys.argv.__len__() < 2:
        folderMode = input('Folder mode? (Y/N)\n>').lower() == 'y'
        folder = input('What folder are these files in? (leave blank if no folder)\n> ')
        if not folderMode:
                fileNames = input('Give filenames (Seperated by comma, exclude extension)\n> ').split(',')
else:
        folderMode = sys.argv[1].lower() == 'y'
        folder = sys.argv[2]
        if not folderMode:
                fileNames = sys.argv[3].split(',')

if folderMode:
        fileNames = [f for f in listdir(folder) if isfile(join(folder, f)) and f.endswith('.json')]

for file in fileNames:
        fileNames.remove(file)
        fileNames.append(file.removesuffix('.json'))

if folder.__len__() > 0:
        folder += '/'

for fileName in fileNames:
        filePaths.append(folder + fileName.removesuffix('.json') + '.json')

filePaths.sort()

for file in filePaths:
        jsonFile = open(file, 'r')
        jsonData = json.load(jsonFile)
        fileJsons.append(jsonData)

finalJson = ''    

for data in fileJsons:
        text = data['title']
        header = '# '
        
        keepDate = True
        if 'hideDate' in data:
                if data['hideDate'] == True:
                        keepDate = False
      
        if keepDate and 'date' in data:  
                text += ' ('+data['date']+')\n'
        
        text += data['content'] + '\n\n'
        
        if 'headerType' in data:
                if data['headerType'] == 2:
                        header += ('## ')
                elif data['headerType'] == 3:
                        header += ('### ')
                elif data['headerType'] == 4:
                        header += ('#### ')
                elif data['headerType'] == 5:
                        header += ('##### ')
                elif data['headerType'] == 6:
                        header += ('###### ')
        
        finalJson += (header+text)

finalJson += 'Generated by Blog Writer Iteration '+str(iteration)

print('\n\nPaths: ') 
for path in filePaths:
        print('* ' + path)
print('\n\nCopy this: ') 
print(finalJson)